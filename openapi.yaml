openapi: 3.0.2
info:
  title: KristyLessonRecords
  description: |
    ## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–Ω–ª–∞–π–Ω-—É—Ä–æ–∫–æ–≤

    ### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
    - üé• –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–ø–∏—Å—å —É—Ä–æ–∫–æ–≤ —á–µ—Ä–µ–∑ Recall.ai
    - üìù –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —á–µ—Ä–µ–∑ AssemblyAI
    - ü§ñ AI-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ YandexGPT
    - üìö –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
  version: 1.0.0
  contact:
    name: KristyLessonRecords Support
    email: support@kristylessons.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://ai.dr-study.ru
    description: Local development server
  - url: https://api.kristylessons.com
    description: Production server

tags:
  - name: Health
    description: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
  - name: Lessons
    description: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞–º–∏

paths:
  /:
    get:
      tags:
        - Health
      summary: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞
      operationId: root
      responses:
        "200":
          description: Successful Response
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  service:
                    type: string
                    example: KristyLessonRecords

  /lessons/record:
    post:
      tags:
        - Lessons
      summary: –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å —É—Ä–æ–∫–∞
      description: |
        –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏ –æ–Ω–ª–∞–π–Ω-—É—Ä–æ–∫–∞.
        
        –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:
        1. Recall.ai –±–æ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—Å—è –∫ –≤—Å—Ç—Ä–µ—á–µ
        2. –ù–∞—á–Ω—ë—Ç—Å—è –∑–∞–ø–∏—Å—å –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
        3. –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —É—Ä–æ–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
        4. AI –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –∏ —Å–æ–∑–¥–∞—Å—Ç —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
      operationId: start_recording
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecordLessonRequest"
        required: true
      responses:
        "200":
          description: –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –Ω–∞—á–∞—Ç–∞
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LessonResponse"
              example:
                id: lesson_1234567890.123
                status: recording
                meeting_url: https://zoom.us/j/1234567890
                lesson_type: chinese
                created_at: "2024-01-20T10:30:00"
                transcript_available: false
                materials_available: false
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HTTPValidationError"
        "500":
          description: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∑–∞–ø–∏—Å–∏

  /lessons/{lesson_id}:
    get:
      tags:
        - Lessons
      summary: –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–∫–µ
      description: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–∫–µ
      operationId: get_lesson
      parameters:
        - required: true
          schema:
            title: Lesson Id
            type: string
            description: ID —É—Ä–æ–∫–∞
            example: lesson_1234567890.123
          name: lesson_id
          in: path
      responses:
        "200":
          description: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Ä–æ–∫–µ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LessonResponse"
        "404":
          description: –£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω
        "422":
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HTTPValidationError"

  /lessons/{lesson_id}/transcript:
    get:
      tags:
        - Lessons
      summary: –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é —É—Ä–æ–∫–∞
      description: |
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é —É—Ä–æ–∫–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–º–∏ —Å–ø–∏–∫–µ—Ä–∞–º–∏.
        
        –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:
        - –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞
        - –°–µ–≥–º–µ–Ω—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
        - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–∏–∫–µ—Ä–∞—Ö
        - –Ø–∑—ã–∫ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
      operationId: get_transcript
      parameters:
        - required: true
          schema:
            title: Lesson Id
            type: string
            description: ID —É—Ä–æ–∫–∞
          name: lesson_id
          in: path
      responses:
        "200":
          description: –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —É—Ä–æ–∫–∞
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: transcript_123
                  text:
                    type: string
                    example: "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: –ü—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è –º—ã –∏–∑—É—á–∞–µ–º —á–∏—Å–ª–∞. –ù–∞ –∫–∏—Ç–∞–π—Å–∫–æ–º –æ–¥–∏–Ω –±—É–¥–µ—Ç ‰∏Ä (yƒ´)..."
                  segments:
                    type: array
                    items:
                      type: object
                      properties:
                        text:
                          type: string
                        start:
                          type: number
                        end:
                          type: number
                        speaker:
                          type: string
                  language:
                    type: string
                    example: ru
                  duration:
                    type: number
                    example: 1800.0
        "404":
          description: –£—Ä–æ–∫ –∏–ª–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

  /lessons/{lesson_id}/materials:
    get:
      tags:
        - Lessons
      summary: –ü–æ–ª—É—á–∏—Ç—å —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
      description: |
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ AI —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —É—Ä–æ–∫–∞.
        
        –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤–∫–ª—é—á–∞—é—Ç:
        - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è** - —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∏–µ—Ä–æ–≥–ª–∏—Ñ–∞–º–∏ –∏ –ø–∏–Ω—å–∏–Ω—å
        - **–ö–æ–Ω—Å–ø–µ–∫—Ç —É—Ä–æ–∫–∞** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ
        - **–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ** - —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è
        - **–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** - —á—Ç–æ –∏–∑—É—á–∞–ª–∏ –Ω–∞ —É—Ä–æ–∫–µ
        - **–°–ª–æ–≤–∞—Ä—å** - –∫–ª—é—á–µ–≤–∞—è –ª–µ–∫—Å–∏–∫–∞ —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º
      operationId: get_materials
      parameters:
        - required: true
          schema:
            title: Lesson Id
            type: string
            description: ID —É—Ä–æ–∫–∞
          name: lesson_id
          in: path
      responses:
        "200":
          description: –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
          content:
            application/json:
              schema:
                type: object
                properties:
                  lesson_id:
                    type: string
                  original_transcript:
                    type: string
                  corrected_transcript:
                    type: string
                  summary:
                    type: string
                  homework:
                    type: string
                  notes:
                    type: string
                  vocabulary:
                    type: array
                    items:
                      type: object
                      properties:
                        word:
                          type: string
                        pinyin:
                          type: string
                        translation:
                          type: string
                        example:
                          type: string
                  created_at:
                    type: string
                    format: date-time
        "404":
          description: –£—Ä–æ–∫ –∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

components:
  schemas:
    RecordLessonRequest:
      title: RecordLessonRequest
      required:
        - meeting_url
        - lesson_type
      type: object
      properties:
        meeting_url:
          title: Meeting Url
          type: string
          description: URL –≤—Å—Ç—Ä–µ—á–∏ (Zoom, Google Meet –∏ —Ç.–¥.)
          example: https://zoom.us/j/1234567890
        lesson_type:
          title: Lesson Type
          type: string
          description: –¢–∏–ø —É—Ä–æ–∫–∞
          example: chinese
          pattern: ^(chinese|english)$
        student_id:
          title: Student Id
          type: string
          description: ID —Å—Ç—É–¥–µ–Ω—Ç–∞
          example: student_123
        teacher_id:
          title: Teacher Id
          type: string
          description: ID –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
          example: teacher_456
        student_level:
          title: Student Level
          type: string
          description: –£—Ä–æ–≤–µ–Ω—å —Å—Ç—É–¥–µ–Ω—Ç–∞
          example: beginner
          pattern: ^(beginner|intermediate|advanced)$
        metadata:
          title: Metadata
          type: object
          description: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
          example:
            topic: "–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 10"
            lesson_number: 5
      example:
        meeting_url: https://zoom.us/j/1234567890
        lesson_type: chinese
        student_id: student_123
        student_level: beginner
        metadata:
          topic: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
          lesson_number: 1

    LessonResponse:
      title: LessonResponse
      required:
        - id
        - status
        - meeting_url
        - lesson_type
        - created_at
      type: object
      properties:
        id:
          title: Id
          type: string
          description: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —É—Ä–æ–∫–∞
          example: lesson_1234567890.123
        status:
          title: Status
          type: string
          description: –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É—Ä–æ–∫–∞
          example: recording
          pattern: ^(recording|transcribing|processing|completed|failed)$
        meeting_url:
          title: Meeting Url
          type: string
          description: URL –≤—Å—Ç—Ä–µ—á–∏
          example: https://zoom.us/j/1234567890
        lesson_type:
          title: Lesson Type
          type: string
          description: –¢–∏–ø —É—Ä–æ–∫–∞
          example: chinese
        created_at:
          title: Created At
          type: string
          description: –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
          format: date-time
        transcript_available:
          title: Transcript Available
          type: boolean
          description: –î–æ—Å—Ç—É–ø–Ω–∞ –ª–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
          default: false
        materials_available:
          title: Materials Available
          type: boolean
          description: –î–æ—Å—Ç—É–ø–Ω—ã –ª–∏ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
          default: false

    HTTPValidationError:
      title: HTTPValidationError
      type: object
      properties:
        detail:
          title: Detail
          type: array
          items:
            $ref: "#/components/schemas/ValidationError"

    ValidationError:
      title: ValidationError
      required:
        - loc
        - msg
        - type
      type: object
      properties:
        loc:
          title: Location
          type: array
          items:
            anyOf:
              - type: string
              - type: integer
        msg:
          title: Message
          type: string
        type:
          title: Error Type
          type: string 